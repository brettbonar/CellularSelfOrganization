<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Identification of Self-Organizing Multicellular Systems by brettbonar</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Identification of Self-Organizing Multicellular Systems</h1>
      <h2 class="project-tagline"></h2>
      <a href="https://github.com/brettbonar/CellularSelfOrganization" class="btn">View on GitHub</a>
      <a href="https://github.com/brettbonar/CellularSelfOrganization/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/brettbonar/CellularSelfOrganization/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h3>
<a id="cellular-self-organization" class="anchor" href="#cellular-self-organization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cellular Self-Organization</h3>

<p>Self-organization could be defined as the undirected movement of a chaotic structure into an ordered one. In a biological system, this may be seen as a formation of cells gradually reforms into a regular arrangement. Such arrangements could be lattices or grids that are identified as having regular or repeating patterns. Determining the behaviors with which to compose a self-organizing system is a nontrivial task. While many such systems have already been identified, the considerable amount of traits comprising cellular behaviors would make an exhaustive search of undiscovered systems impossible. The ability to discover these types of systems could prove valuable to disciplines such as medicine and bioengineering where regular patterns have real applications.</p>

<p>The below image links to a video showing the growth of a self-organizing system.</p>

<p><a href="https://www.youtube.com/watch?v=oYwL2J0_ezg"><img src="http://img.youtube.com/vi/oYwL2J0_ezg/0.jpg" alt="Self-Organization of a Multicellular System"></a></p>

<h3>
<a id="goals" class="anchor" href="#goals" aria-hidden="true"><span class="octicon octicon-link"></span></a>Goals</h3>

<p>The goal of this project is to create a tool that is capable of identifying biological systems that organize into regular patterns. A biological system in this case is composed of one or more cell types and their behaviors. These cells will be simulated using the <a href="http://www.compucell3d.org/">CompuCell3D Simulator</a> to determine if they are "self-organizing".</p>

<p>The idea is that these cells and their behaviors could then be replicated in the real world where their organized patterns may prove useful. Such cells could already exist in nature or be grown in a lab through genetic engineering processes.</p>

<h3>
<a id="method" class="anchor" href="#method" aria-hidden="true"><span class="octicon octicon-link"></span></a>Method</h3>

<p>This project implements a simple hill climber written in Python that works on a limited set of cellular behaviors from the CompuCell3D simulator. An evaluation of the set complexity of the simulated result of a biological system is used to determine self-organization and regularity (i.e. the fitness function).</p>

<p>While CompuCell3D supports 3D cells, this simulation is limited to 2D for the purpose of simplicity and simulation speed. The CompuCell3D simulator supports a large number of cell attributes and behaviors. These have been narrowed down to a few variable parameters:</p>

<ul>
<li>Contact (adhesion) energy between cells</li>
<li>Diffusion field parameters:

<ul>
<li>Decay rate</li>
<li>Diffusion constant</li>
<li>Secretion rate for each cell type</li>
</ul>
</li>
<li>Chemotaxis for each cell type</li>
</ul>

<p>The diffusion field and chemotaxis parameters are directly related. This project uses the CompuCell3D DiffusionSolverFE plugin to simulate chemotaxis. The secretion rate is the amount of chemical field that is secreted by each cell type. Chemotaxis then defines the rate at which cells are attracted to the chemical field. Chemotaxis is one of the most important and useful cellular properties for creating self-organizing biological systems.</p>

<p>The hill climber begins with a random configuration of the above parameters in addition to a random number of cell types (currently just one or two) and random volume for each type of cell. Number of cell types and cell volume are not changed between iterations. The initial configuration is run through the CompuCell3D simulator four times with different random seeds to generate four distinct results. Each simulation is run for 1000 Monte Carlo Steps (MCS). Each MCS step is one iteration of the simulation. The set complexity is then calculated using the four final outputs as the set.</p>

<p>The algorithm repeatedly performs a random walk on one of the variable parameters. If the resulting set complexity of the simulation is better than the previous best then this is taken as the new best result. This is repeated until no improvements have been made for a number of iterations, at which point the hill climber terminates and an XML file representing the latest best configuration is output.</p>

<p>The method used to calculate set complexity is as given by Dr. Flann and adapted to use image compression techniques on Dr. Flann's advice. The calculation of set complexity depends on the Kolmogorov complexity of a set of objects (in this case images output by the simulator), which can be estimated by the Normalized Compression Distance (NCD). The NCD can be considered a measure of the similarity of two objects. NCD is maximized when both inputs are random or dissimilar and is minimized when both objects are identical. NCD is calculated with the following formula:</p>

<p><img src="https://cloud.githubusercontent.com/assets/7144970/11803555/4693a18c-a2b9-11e5-9a94-21f043708796.png" alt="ncd"></p>

<p>Where C(x) and C(y) are the compressed sizes of two input images and C(x+y) is the compressed size of the concatenation of both images.</p>

<p>Set complexity can then be defined as an evaluation of the NCD for each pair of inputs:</p>

<p><img src="https://cloud.githubusercontent.com/assets/7144970/11803550/3e8ff85a-a2b9-11e5-9fa2-b8c4fe471ddb.png" alt="setcomplexity"></p>

<p>This implementation uses PNG compression on grayscale-converted images that are output by the CompuCell3D simulator. Images are concatenated for the NCD calculation by horizontally aligning them. There was a surprisingly significant difference in NCD results between vertical and horizontal concatenation. Horizontal concatenation was chosen because it gave a wider range of NCD values.</p>

<p>This method of evaluating set complexity was used on a subset of the problem domain. Two identical cell types were created (Cell 1 and Cell 2) and the contact energy between these two types was set to 10. The following heat map was generated by testing the effects of change in contact energy between cells of the same type. Note that simulations were run only for test cases under the diagonal and the remainder was extrapolated. Since all parameters other than contact energy were identical, there is no reason to expect (0,2) to differ in any way from (2,0). Red in this case indicates a high set complexity result. The second image shows example output at various contact energies. The initial cell positions were set using the same seed so the difference in organization can be better observed.</p>

<p><img src="https://cloud.githubusercontent.com/assets/7144970/11859709/f7884732-a42a-11e5-919c-7dd12eec52bb.png" alt="heatmap"></p>

<p><img src="https://cloud.githubusercontent.com/assets/7144970/11859710/f87d6c30-a42a-11e5-98fd-9de4f0b92792.png" alt="contactenergyoutput"></p>

<p>These results show that set complexity is at least a viable method in distinguishing between simple and complex systems.</p>

<h3>
<a id="results" class="anchor" href="#results" aria-hidden="true"><span class="octicon octicon-link"></span></a>Results</h3>

<p>The following are examples of runs of the hill climber. The CompuCell3D simulator was run on each iteration for 1000 MCS and the final output of four runs with different random seeds were evaluated for complexity.</p>

<p>This image shows the advancement of the hill climber with each iteration. Each image shows the final output of that iteration after 1000 MCS. It is interesting to see how the output begins with very simple organization and gradually evolves into a complex network over several iterations.</p>

<p><img src="https://cloud.githubusercontent.com/assets/7144970/11859718/0d88d894-a42b-11e5-9c92-f54a46f5b3b3.png" alt="hillclimberiterations"></p>

<p>The first set of charts shows one run of the hill climber, recording both the complexity at each iteration and the best complexity so far. Note the sudden improvement in complexity starting from iteration 18 and the seemingly random spikes and dips. It was often observed how alterations to a single parameter could result in a drastic change in complexity such as this.</p>

<p><img src="https://cloud.githubusercontent.com/assets/7144970/11863421/f1e8603e-a450-11e5-8e24-a271359dcaa1.png" alt="actualcomplexity1">
<img src="https://cloud.githubusercontent.com/assets/7144970/11863419/f1e3cee8-a450-11e5-9073-2dc7d36d37f6.png" alt="bestcomplexity1"></p>

<p>Compare the previous charts with this next set where the improvement is much more gradual. It is interesting to observe how different each run can be.</p>

<p><img src="https://cloud.githubusercontent.com/assets/7144970/11863418/f1e3cc0e-a450-11e5-84e6-edf71df6b0f0.png" alt="actualcomplexity2">
<img src="https://cloud.githubusercontent.com/assets/7144970/11863420/f1e427e4-a450-11e5-9fbd-59aa95412c3a.png" alt="bestcomplexity2"></p>

<p>These are a few other results that (I think) are interesting:</p>

<p><img src="https://cloud.githubusercontent.com/assets/7144970/11803862/1781fc88-a2bc-11e5-8892-ef1587f44a49.png" alt="example2">
<img src="https://cloud.githubusercontent.com/assets/7144970/11803863/1863228a-a2bc-11e5-904b-dfdea11df876.png" alt="example3">
<img src="https://cloud.githubusercontent.com/assets/7144970/11803864/195edbf2-a2bc-11e5-99ba-1506df56e964.png" alt="example4">
<img src="https://cloud.githubusercontent.com/assets/7144970/11803872/2abac19a-a2bc-11e5-8f71-fbdfd7c6e763.png" alt="networkend"></p>

<h3>
<a id="issues" class="anchor" href="#issues" aria-hidden="true"><span class="octicon octicon-link"></span></a>Issues</h3>

<p>While this method works well in distinguishing between simple and complex systems, it does not always succeed in distinguishing between organized and random complexity. In the following comparison, one would expect the first image to result in a higher complexity, yet the hill climber continued to search and determined that the second image was better.</p>

<p><img src="https://cloud.githubusercontent.com/assets/7144970/11859910/d0290576-a42c-11e5-91f5-d5a63984fa0e.png" alt="badexamplecompare"></p>

<p>The second image is clearly random with no discernable pattern or organization. I have observed two situations that lead to unexpected set complexity results such as this:</p>

<ul>
<li>Simple images with a low compressed size and disproportionately low NCD values. The low compressed size should result in a lower set complexity, but this is occasionally offset by relatively low NCD values close to 0.5.</li>
<li>Complex, random images with very high compressed sizes and high NCD values. The significantly higher compression size often has enough of an impact to result in a high set complexity for random systems, even if NCD is also high.</li>
</ul>

<h3>
<a id="future-work" class="anchor" href="#future-work" aria-hidden="true"><span class="octicon octicon-link"></span></a>Future Work</h3>

<p>Future work may include developing more specialized algorithms to better identify specific patterns, or searching for different methods of compression that result in a wider range of NCD values.</p>

<p>Another future task may be to make the system more configurable. Currently, there is no external control over which cell attributes are modified and to what extent. One user may only want chemotaxis to be variable between iterations, while another may want to remove chemotaxis altogether. It may also be beneficial to give users the option of specifying the initial cell behaviors rather than have them randomly generated each time.</p>

<h3>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h3>

<p>The program runs from a single batch script. This is in order to use the same setup that the CC3D simulator uses (also in a .bat file).</p>

<ol>
<li>Install <a href="http://www.compucell3d.org/">CompuCell3D</a>
</li>
<li>Open CompuCell3D and go to Tools -&gt; Configuration. Check "Save Image Every Nth MCS" and set the value to 1000.</li>
<li>If CompuCell3D is installed anywhere other than C:/CompuCell3D then open simulation.bat at the root level of the repo and change the second line to point to your CompuCell3D installation.</li>
<li>Run simulation.bat. Your output files will be placed in the same directory as simulation.bat under /Output/. Best.txt, Complexity.txt, Best.png, and Best.xml will be updated with each iteration.

<ul>
<li>Best.txt - List of best set complexities found so far</li>
<li>Complexity.txt - List of set complexity for each iteration</li>
<li>Best.png - Output image for best complexity found so far</li>
<li>Best.xml - Cell parameters for best configuration found so far</li>
</ul>
</li>
</ol>

<p>Contact me at <a href="mailto:brettbonar@gmail.com">brettbonar@gmail.com</a> if you have any issues. There may be additional setup for CompuCell3D that I don't remember doing.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/brettbonar/CellularSelfOrganization">Identification of Self-Organizing Multicellular Systems</a> is maintained by <a href="https://github.com/brettbonar">brettbonar</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
